function initForm(){const e=document.getElementById("registrationForm"),t=document.getElementById("name"),n=document.getElementById("phone"),o=document.getElementById("nameError"),d=document.getElementById("phoneError"),a=document.getElementById("selectedCountryCode"),i=document.getElementById("countryDropdown"),l=document.getElementById("dropdownIcon"),r=document.getElementById("unlockBtn"),s=document.getElementById("timer");let c=1800;const pad=e=>String(e).padStart(2,"0"),setTime=e=>{const t=`${pad(Math.floor(e/60))}:${pad(e%60)}`;s.textContent!==t&&(s.textContent=t),r&&r.textContent!==`Ro'yxatdan o'tish (${t})`&&(r.textContent=`Ro'yxatdan o'tish (${t})`)};function startCountdown(){const e=Date.now()+1e3*c;window.__timerStarted=!0;const t=setInterval(()=>{const n=Math.max(0,Math.round((e-Date.now())/1e3));c=n,n<=0?(clearInterval(t),r&&(r.disabled=!1,r.removeAttribute("aria-disabled"),r.textContent="Ro'yxatdan o'tish"),s.textContent="00:00"):setTime(n)},1e3)}e&&(e.style.display="none"),r&&(r.disabled=!0,r.setAttribute("aria-disabled","true"),setTime(c)),r&&r.addEventListener("click",()=>{r.disabled||(r.style.display="none",e&&(e.style.display="block",setTimeout(()=>t?.focus(),0)))});const u=[{name:"Uzbekistan",code:"+998"},{name:"AQSH",code:"+1"},{name:"Janubiy Koreya",code:"+82"},{name:"Qirg'iziston",code:"+996"},{name:"Qozog'iston",code:"+7"},{name:"Tojikiston",code:"+992"},{name:"Turkmaniston",code:"+993"},{name:"Polsha",code:"+48"}],m={"+998":{ph:"88 888 88 88",re:/^\d{2} \d{3} \d{2} \d{2}$/,cut:9,max:12},"+1":{ph:"555 123 4567",re:/^\d{3} \d{3} \d{4}$/,cut:10,max:12},"+82":{ph:"10 1234 5678",re:/^\d{2} \d{4} \d{4}$/,cut:10,max:12},"+996":{ph:"555 123 456",re:/^\d{3} \d{3} \d{3}$/,cut:9,max:11},"+7":{ph:"700 123 4567",re:/^\d{3} \d{3} \d{4}$/,cut:10,max:12},"+992":{ph:"55 555 5555",re:/^\d{2} \d{3} \d{4}$/,cut:9,max:11},"+993":{ph:"6 123 4567",re:/^\d{1} \d{3} \d{4}$/,cut:8,max:10},"+48":{ph:"123 456 789",re:/^\d{3} \d{3} \d{3}$/,cut:9,max:11}};let p="+998";function safeRun(e,t=300){try{"requestIdleCallback"in window?requestIdleCallback(e,{timeout:500}):setTimeout(e,t)}catch{setTimeout(e,t)}}n.placeholder=m[p].ph,n.maxLength=m[p].max,n.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"").slice(0,m[p].cut);"+998"===p&&(t.length>2&&t.length<=5?t=t.replace(/(\d{2})(\d{0,3})/,"$1 $2"):t.length>5&&t.length<=7?t=t.replace(/(\d{2})(\d{3})(\d{0,2})/,"$1 $2 $3"):t.length>7&&(t=t.replace(/(\d{2})(\d{3})(\d{2})(\d{0,2})/,"$1 $2 $3 $4"))),e.target.value=t,d.style.display="none"}),t.addEventListener("input",()=>o.style.display="none"),e.addEventListener("submit",a=>{if(a.preventDefault(),!t.value.trim())return void(o.style.display="block");if(!m[p].re.test(n.value))return void(d.style.display="block");const i={name:t.value.trim(),phone:`${p} ${n.value}`,time:(new Date).toLocaleString("uz-UZ"),uid:Date.now().toString()};localStorage.setItem("FormData",JSON.stringify(i)),e.querySelector("button").disabled=!0,window.location.href="/thankYou.html"}),safeRun(function setupCountries(){a.addEventListener("click",()=>{const e="block"===i.style.display;i.style.display=e?"none":"block",l.innerHTML=e?'<polyline points="6 9 12 15 18 9"></polyline>':'<polyline points="18 15 12 9 6 15"></polyline>',e||(i.innerHTML="",u.forEach(e=>{const t=document.createElement("div");t.className="country-option",t.innerHTML=`<span>${e.name}</span><span class="country-code">${e.code}</span>`,t.onclick=()=>{p=e.code,a.textContent=e.code,i.style.display="none",n.placeholder=m[e.code].ph,n.maxLength=m[e.code].max,n.value="",d.style.display="none",l.innerHTML='<polyline points="6 9 12 15 18 9"></polyline>'},i.appendChild(t)}))}),document.addEventListener("click",e=>{a.contains(e.target)||i.contains(e.target)||(i.style.display="none",l.innerHTML='<polyline points="6 9 12 15 18 9"></polyline>')})}),safeRun(startCountdown),setTimeout(()=>{window.__timerStarted||(window.__timerStarted=!0,startCountdown())},1e3),document.addEventListener("touchstart",()=>{window.__timerStarted||(window.__timerStarted=!0,startCountdown())},{once:!0,passive:!0})}function startApp(){requestAnimationFrame(()=>{"requestIdleCallback"in window?requestIdleCallback(initForm,{timeout:1e3}):setTimeout(initForm,100)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",startApp):startApp();